(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{179:(e,s,t)=>{Promise.resolve().then(t.bind(t,3194))},3194:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var l=t(5155),i=t(2115);function r(){let[e,s]=(0,i.useState)(""),[t,r]=(0,i.useState)(!1),[a,n]=(0,i.useState)(null),[o,d]=(0,i.useState)(null),c=async()=>{if(!e){d("Admin key is required");return}r(!0),d(null),n(null);try{let s=await fetch("/api/disable-storage-rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:e})}),t=await s.json();if(!s.ok)throw Error(t.error||"Failed to disable RLS");n(t.results)}catch(e){d(e.message)}finally{r(!1)}},m=async()=>{if(!e){d("Admin key is required");return}r(!0),d(null),n(null);try{let s=await fetch("/api/fix-upload-permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:e})}),t=await s.json();if(!s.ok)throw Error(t.error||"Failed to fix permissions");n(t.results)}catch(e){d(e.message)}finally{r(!1)}};return(0,l.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Fix Upload Permissions"}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("label",{htmlFor:"adminKey",className:"block text-sm font-medium text-gray-300 mb-2",children:"Admin Setup Key"}),(0,l.jsx)("input",{type:"password",id:"adminKey",value:e,onChange:e=>s(e.target.value),className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"Enter your admin setup key"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"bg-gray-700 p-4 rounded",children:[(0,l.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Option 1: Disable RLS (Recommended)"}),(0,l.jsx)("p",{className:"mb-4 text-gray-300",children:"This will completely disable Row Level Security for storage, allowing all operations without restrictions."}),(0,l.jsx)("button",{onClick:c,disabled:t,className:"w-full py-2 px-4 bg-red-600 hover:bg-red-700 text-white font-medium rounded transition-colors disabled:opacity-50",children:t?"Processing...":"Disable Storage RLS"})]}),(0,l.jsxs)("div",{className:"bg-gray-700 p-4 rounded",children:[(0,l.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Option 2: Fix Bucket Permissions"}),(0,l.jsx)("p",{className:"mb-4 text-gray-300",children:"This will make all buckets public and grant all permissions to authenticated users."}),(0,l.jsx)("button",{onClick:m,disabled:t,className:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded transition-colors disabled:opacity-50",children:t?"Processing...":"Fix Bucket Permissions"})]})]}),o&&(0,l.jsx)("div",{className:"mt-4 p-3 bg-red-900/50 border border-red-700 rounded text-red-300",children:o}),a&&(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Results:"}),(0,l.jsx)("div",{className:"bg-gray-900 p-4 rounded overflow-auto max-h-60",children:(0,l.jsx)("pre",{className:"text-sm text-gray-300",children:JSON.stringify(a,null,2)})})]}),(0,l.jsxs)("div",{className:"mt-6 p-4 bg-yellow-900/30 border border-yellow-700/50 rounded",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Important Note"}),(0,l.jsx)("p",{className:"text-yellow-200 text-sm",children:"These options will remove security restrictions on your storage buckets. This is fine for development and testing, but should be properly configured before deploying to production."})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[441,684,358],()=>s(179)),_N_E=e.O()}]);